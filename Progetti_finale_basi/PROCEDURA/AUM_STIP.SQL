/*
PROCEDURA CHE AUMENTA LO STIPENDIO DI UN DIRETTORE CHE LAVORA DA PIU DI 5 ANNI.
*/

CREATE OR REPLACE PROCEDURE AUM_STIP IS
CURSOR C1 IS SELECT CF_DIRETTORE,STIPENDIO,(TO_CHAR(SYSDATE,'YYYY')-(TO_CHAR(DATA_ASSUNZIONE,'YYYY'))) AS DATA_ASS
			 FROM  DIRETTORE;

EMP_REC C1%ROWTYPE;
BEGIN

OPEN C1;
LOOP
FETCH C1 INTO EMP_REC;
EXIT WHEN C1 %NOTFOUND;
IF(EMP_REC.DATA_ASS>=5) THEN 
UPDATE DIRETTORE SET STIPENDIO=EMP_REC.STIPENDIO+500 WHERE CF_DIRETTORE=EMP_REC.CF_DIRETTORE;
END IF;
END LOOP;
CLOSE C1;
COMMIT;
END AUM_STIP;
/

