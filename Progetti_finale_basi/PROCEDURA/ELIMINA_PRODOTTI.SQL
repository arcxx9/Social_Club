-- Eliminare gli approvvigionamenti e le forniture pi√π vecchie di 5 anni.

CREATE OR REPLACE PROCEDURE ELIMINA_PRODOTTI 
IS
CONTA_FOR NUMBER;
CONTA_APP NUMBER;

BEGIN

SELECT COUNT(*) INTO CONTA_APP 
FROM APPROVVIGIONAMENTO
WHERE DATA_APPROVVIGIONAMENTO < (SYSDATE-1825); 
IF  CONTA_APP >=1 THEN
DELETE FROM APPROVVIGIONAMENTO WHERE  DATA_APPROVVIGIONAMENTO<(SYSDATE-1825);
DBMS_OUTPUT.PUT_LINE('APPROVVIGIONAMENTI PIU VECCHI DI 5 ANNI CANCELLATI');
COMMIT;
END IF;


SELECT COUNT(*) INTO CONTA_FOR
FROM FORNITURA
WHERE DATA_FOR < (SYSDATE-1825); 
IF CONTA_FOR >= 1 THEN
DELETE FROM FORNITURA WHERE DATA_FOR<(SYSDATE-1825);
DBMS_OUTPUT.PUT_LINE('FORNITURE PIU VECCHIE DI 5 ANNI CANCELLATE');
COMMIT;
END IF;
END ELIMINA_PRODOTTI;
/

