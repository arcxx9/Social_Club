CREATE OR REPLACE FUNCTION BESTP
RETURN VARCHAR IS 
Q_VENDUTA NUMBER;
COD_PROD VARCHAR(20);
BEGIN
SELECT MAX(SUM(QUANTITA_C)) INTO Q_VENDUTA 
FROM CONTIENE
GROUP BY COD_BARRE;
					
SELECT COD_BARRE INTO COD_PROD
FROM PRODOTTO
WHERE COD_BARRE = ANY(	SELECT COD_BARRE 
						FROM  CONTIENE
						GROUP BY COD_BARRE
						HAVING SUM(QUANTITA_C)=Q_VENDUTA);
						
RETURN COD_PROD;
END BESTP;
/				
